<!DOCTYPE html>
<html xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layout.html}">
<body>
	<section layout:fragment="content">
	 <nav aria-label="breadcrumb">
	  <ol class="breadcrumb">
	    <li class="breadcrumb-item"><a href="#"> <i class="fa fa-home fa-sm" style="font-size:20px;color:black;"></i></a></li>
	    <li class="breadcrumb-item"><a href="#">Home</a></li>
	    <li class="breadcrumb-item"><a href="#">Processos</a></li>
	    <li class="breadcrumb-item"><a href="#">Tramitar Processo</a></li>
	   <!--  <li class="breadcrumb-item">Criar Novo Processo</li> -->
	    
	  </ol>
</nav>

		<div class="card m-4">
			<div class="card-header">Tramitar Processo</div>
			<div class="card-body">
				<form th:action="@{/servidores/save}" th:object="${tramite}"
					method="post" class="row g-3" id="frm">
					
					<div class="col-6 mb-3">
						<label for="nome" class="form-label">Origem</label> <input
							type="text" id="nome" class="form-control" th:field="*{setorcriador}" readonly="readonly"
							placeholder="Nome"> 
					</div>

					<div class="col-md-6 mb-3">
						<label for="cpf" class="form-label">Destino</label> 
						 <select id="destino" class="form-select form-select-sm" th:field="*{setordestino}"> 	
						   <option th:text="${'Selecione o Setor'}" th:value="${'0'}">	
		        		   <option th:each="s : ${setores}" th:text="${s.nome}" th:value="${s.id}">					      	       
		    		  </select>		
		    		  
					</div>
					
					<div class="col-md-6 mb-3">
						<label for="cpf" class="form-label">Processo</label> 
						 <select id="processo" class="form-select form-select-sm" th:field="*{procId}">  
						    <option th:text="${'Selecione o processo'}" th:value="${'0'}">	
		        			<option th:each="p : ${processo}" th:text="${p.numanoproc} +  ' | ' + ${p.assunto} " th:value="${p.id}">	
		    		  </select>	
					</div>
					
		
					<div class="col-md-6 mb-3">
						<label for="rg" class="form-label">Criador</label> <input type="text"
							id="rg" class="form-control" th:field="${processo.usucriadorId}" placeholder="" readonly="readonly"> 
					</div>			
                 

                    <div class="col-12 mt-3">
                        <button type="submit"
										class="btn btn-primary btn-sm">Salvar</button>
                    </div>
                
							</form>
            </div>
        </div>
    </section>

    <div layout:fragment="jscript">
       <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
  	   <script
			src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
 	   <script
			src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

 	   <script>
            var URL = '[[@{/}]]';
           
       
            
            $("#loader").show();
            $(document).ready(function() {
                $("#loader").hide();
                $("#salvar").click(function(event) {
                    event.preventDefault();
                    var data = $(event.delegateTarget).data();
                    var id = data.recordId;
                    swal({
                        title: 'Salvar?',
                        text: "Deseja salvar novo Usuario?",
                        icon: 'warning',
                        buttons: [true, "Sim Salvar!"]
                    }).then((result) => {
                        if (result) {
                            var frm = $("#frm").submit();
                        }
                    })
                });
            });
            
            
            
            $("#orgao").change(function(){
            	 var orgao = $("#orgao").val();
            	 
            	 $.ajax({
           		  url: URL + "/localidades/orgao/"+orgao,
           		  method: "GET",
           		}).done(function(data) {
           			$('#localidade').append($('<option>', {value: 0, text : "Selecione a Localidade" }));
           			$.each( data, function( index, rs ){
           				$('#localidade').append($('<option>', { 
           			        value: rs.id,
           			        text : rs.nome 
           			    }));
           			});
           			 $("#loader").hide();
           		}); 
            	
             });
            
            
            $("#localidade").change(function(){
             var orgao = $("#orgao").val();
           	 var localidade = $("#localidade").val();
           	 
           	 $.ajax({
          		  url: URL + "/unidades/orgao/"+orgao+"/localidade/"+localidade,
          		  method: "GET",
          		}).done(function(data) {
          			$('#unidade').append($('<option>', {value: 0, text : "Selecione a Unidade" }));
          			$.each( data, function( index, rs ){
          				$('#unidade').append($('<option>', { 
          			        value: rs.id,
          			        text : rs.nome 
          			    }));
          			});
          			 $("#loader").hide();
          		}); 
           	
            });
            
            $("#unidade").change(function(){
                 var orgao = $("#orgao").val();
              	 var localidade = $("#localidade").val();
              	 var unidade = $("#unidade").val();
              	 
              	 $.ajax({
             		  url: URL + "/setores/orgao/"+orgao+"/localidade/"+localidade+"/unidade/"+unidade,
             		  method: "GET",
             		}).done(function(data) {
             			$('#setor').append($('<option>', {value: 0, text : "Selecione o Setor" }));
             			$.each( data, function( index, rs ){
             				$('#setor').append($('<option>', { 
             			        value: rs.id,
             			        text : rs.nome 
             			    }));
             			});
             			 $("#loader").hide();
             		}); 
              	
               });
            
            
        </script>
    </div>
</body>
</html>
